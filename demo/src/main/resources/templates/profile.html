<!DOCTYPE html>
<html xmlns:th="http://www.thymeleaf.org">
<head>
    <meta charset="UTF-8">
    <title>Meu Perfil - Biblioconnect</title>
    <style>
        body { font-family: Inter, Arial, Helvetica, sans-serif; max-width: 900px; margin: 40px auto; background:#f6f8fb; color:#111827 }
        .container { display: flex; gap: 20px; align-items: flex-start; }

        /* Estilos dos Cards */
        .card { background: white; border: 1px solid #e6e9ee; padding: 24px; border-radius: 12px; box-shadow: 0 4px 12px rgba(0,0,0,0.03); }
        .card-sidebar { flex: 1; text-align: center; }
        .card-main { flex: 2; }

        /* Avatar */
        .avatar-preview { width: 120px; height: 120px; border-radius: 50%; object-fit: cover; border: 4px solid #eef2ff; margin-bottom: 15px; background-color: #eee; }

        /* Formulário */
        .form-group { margin-bottom: 16px; text-align: left; }
        label { display: block; margin-bottom: 6px; font-weight: 600; font-size: 0.9em; color: #374151; }
        input[type=text], textarea { width: 100%; padding: 10px; border: 1px solid #d1d5db; border-radius: 6px; box-sizing: border-box; font-family: inherit; }
        input[type=text]:focus, textarea:focus { border-color: #4f46e5; outline: none; box-shadow: 0 0 0 3px rgba(79, 70, 229, 0.1); }
        textarea { resize: vertical; min-height: 80px; }

        /* Botões */
        .btn { background: #4f46e5; color: white; padding: 10px 20px; border: none; border-radius: 8px; font-weight: 500; cursor: pointer; transition: all 0.2s; text-decoration: none; display: inline-block; }
        .btn:hover { background: #4338ca; transform: translateY(-1px); }
        .btn-secondary { background: white; color: #374151; border: 1px solid #d1d5db; margin-left: 10px; }
        .btn-secondary:hover { background: #f9fafb; }

        /* Utilitários */
        h2 { margin-top: 0; font-size: 1.5em; }
        .muted { color: #6b7280; font-size: 0.9em; margin-bottom: 20px; }
        .badge { background: #e0e7ff; color: #4338ca; padding: 4px 8px; border-radius: 4px; font-size: 0.8em; font-weight: bold; }

        /* Mobile */
        @media (max-width: 600px) { .container { flex-direction: column; } .card-sidebar, .card-main { width: 100%; } }
    </style>
</head>
<body>

<header style="text-align:center; margin-bottom:30px">
    <h1><a th:href="@{/}" style="text-decoration:none; color:inherit">Biblioconnect</a></h1>
</header>

<div class="container">
    <div class="card card-sidebar">
        <img th:src="${user.avatarUrl != null && !user.avatarUrl.isEmpty() ? user.avatarUrl : 'https://ui-avatars.com/api/?name=' + user.name + '&background=random'}"
             alt="Avatar" class="avatar-preview">

        <h2 th:text="${user.name}">Nome do Usuário</h2>
        <p class="muted" th:text="${user.email}">user@email.com</p>

        <div style="margin-top:20px; text-align:left; background:#f9fafb; padding:15px; border-radius:8px">
            <small style="color:#6b7280; text-transform:uppercase; font-size:0.75em; font-weight:bold">Biografia</small>
            <p style="margin-top:5px; font-size:0.95em" th:text="${user.bio != null && !user.bio.isEmpty() ? user.bio : 'Nenhuma biografia adicionada ainda.'}"></p>
        </div>

        <div style="margin-top:20px">
            <span class="badge" th:text="${user.role}">USER</span>
        </div>
    </div>

    <div class="card card-main">
        <div style="display:flex; justify-content:space-between; align-items:center; margin-bottom:20px">
            <h2>Editar Perfil</h2>
        </div>

        <form th:action="@{/profile/update}" method="post" th:object="${user}">
            <div th:if="${param.success}" style="background:#dcfce7; color:#166534; padding:10px; border-radius:6px; margin-bottom:15px">
                Perfil atualizado com sucesso!
            </div>

            <div class="form-group">
                <label for="name">Nome Completo</label>
                <input type="text" id="name" th:field="*{name}" required>
            </div>

            <div class="form-group">
                <label for="avatarUrl">Link da Foto (URL)</label>
                <input type="text" id="avatarUrl" th:field="*{avatarUrl}" placeholder="Ex: https://i.imgur.com/suafoto.jpg">
                <small style="color:#6b7280; display:block; margin-top:4px">Cole o link direto de uma imagem da internet.</small>
            </div>

            <div class="form-group">
                <label for="bio">Sobre Mim (Bio)</label>
                <textarea id="bio" th:field="*{bio}" placeholder="Conte um pouco sobre seus livros favoritos..."></textarea>
            </div>

            <div style="margin-top:25px">
                <button type="submit" class="btn">Salvar Alterações</button>
                <a th:href="@{/}" class="btn btn-secondary">Voltar ao Início</a>
            </div>
        </form>
    </div>
</div>

</body>
</html>